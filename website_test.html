<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Shapeshifters — Offline Preview</title>
  <meta name="theme-color" content="#EAF2F4" />
  <style>
    :root{
      --bg:#F7F9F9; --sky:#EAF2F4; --sand:#F3EFE6; --mint:#9CCFD3; --sea:#BFDCD2;
      --cream:#FFFFFF; --beige:#CFC6B7; --tan:#B5A089; --brown:#7A6652;
      --caramel:#E7D1A1; --mahogany:#6C584C; --coral:#FF6B5C; --peach:#FFC7A6;
      --citrine:#E8FF90; --ink:#253238; --ink-60: rgba(37,50,56,.60); --ink-70: rgba(37,50,56,.70);
      --border:#D7D5CF; --card: rgba(255,255,255,.8);
    }
    *{box-sizing:border-box} html,body{height:100%} body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color:var(--ink); background: linear-gradient(180deg, var(--sky) 0%, var(--sand) 100%);
    }
    a{color:inherit; text-decoration:none}
    .container{max-width:1200px; margin:0 auto; padding:0 24px}
    .btn{display:inline-flex; align-items:center; justify-content:center; font-size:14px; font-weight:600; padding:12px 18px; border-radius:14px; border:1px solid transparent; cursor:pointer; transition:opacity .2s ease}
    .btn:hover{opacity:.9}
    .btn-cream{background:var(--cream); color:var(--ink)}
    .btn-mint{background:var(--mint); color:#000}
    .btn-outline-coral{background:transparent; border-color:var(--coral); color:var(--coral)}
    .pill{display:inline-flex; align-items:center; gap:10px; border:1px solid var(--border); background:rgba(214,214,214,.35); padding:8px 14px; border-radius:999px; font-size:11px; letter-spacing:.2em; text-transform:uppercase; color:var(--ink-70)}
    .grid{display:grid; gap:32px}
    .grid-2{grid-template-columns: repeat(2, minmax(0,1fr))}
    .grid-3{grid-template-columns: repeat(3, minmax(0,1fr))}
    .grid-4{grid-template-columns: repeat(4, minmax(0,1fr))}
    .card{background:var(--card); border:1px solid var(--border); border-radius:24px; padding:28px}
    .section{padding:88px 0; border-top:1px solid var(--border)}
    h1{font-family: ui-serif, Georgia, serif; margin:0; font-weight:800; text-transform:uppercase; letter-spacing:.02em; line-height:1; font-size:clamp(40px,6vw,90px)}
    h2{font-family: ui-serif, Georgia, serif; margin:0; font-weight:800; line-height:1.1; font-size:clamp(28px,3.2vw,48px)}
    h3{font-family: ui-serif, Georgia, serif; margin:0; font-weight:700; line-height:1.15; font-size:22px}
    p{margin:14px 0; color:var(--ink-70); line-height:1.75}
    ul{margin:14px 0; padding-left:20px; line-height:1.7}
    header.nav{position:fixed; inset:0 0 auto 0; backdrop-filter: blur(16px); background:rgba(255,255,255,.7); border-bottom:1px solid var(--border); z-index:50}
    header .row{display:flex; align-items:center; justify-content:space-between; padding:14px 0}
    nav a{font-size:12px; letter-spacing:.08em; text-transform:uppercase; color:var(--ink-70); margin:0 16px}
    main{padding-top:84px}
    .hero{min-height:88vh; display:flex; align-items:center; justify-content:center; position:relative; overflow:hidden}
    .glow{position:fixed; filter: blur(80px); opacity:.35; z-index:0; pointer-events:none}
    .glow.top{top:-180px; right:-160px; width:700px; height:700px; background: radial-gradient(70% 70% at 50% 50%, var(--coral) 0%, rgba(58,42,34,0) 70%)}
    .glow.bottom{bottom:-220px; left:-200px; width:760px; height:760px; background: radial-gradient(70% 70% at 50% 50%, var(--mint) 0%, rgba(42,163,144,0) 70%)}
    .hero-inner{position:relative; z-index:2; text-align:center; max-width:960px; margin:0 auto}
    .center{display:flex; align-items:center; justify-content:center}
    .sub-hero{min-height:44vh; display:flex; align-items:center; justify-content:center; position:relative; overflow:hidden; border-bottom:1px solid var(--border)}
    .sub-hero .inner{text-align:center; position:relative; z-index:1}
    .footer{background:rgba(255,255,255,.8); border-top:1px solid var(--border)}
    .footer .row{display:flex; align-items:center; justify-content:space-between; padding:12px 0; font-size:14px; color:var(--ink-70)}
    .qs{position:fixed; right:16px; bottom:16px; z-index:60; display:flex; gap:8px; background:rgba(255,255,255,.8); border:1px solid var(--border); border-radius:18px; padding:8px}
    .input{width:100%; padding:12px 14px; border:1px solid var(--border); border-radius:12px; background:rgba(223,223,223,.35)}
    .muted{color:var(--ink-60); font-size:14px}
    .tag{display:inline-block; border:1px solid var(--border); border-radius:10px; padding:4px 8px; font-size:11px; color:var(--ink-70); margin:2px 4px 0 0}
    .avatar{width:100%; height:0; padding-bottom:62.5%; background-size:cover; background-position:center}
    .sr{position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0}
  </style>
</head>
<body>
  <div class="glow top"></div>
  <div class="glow bottom"></div>

  <header class="nav">
    <div class="container row">
      <div class="row" style="gap:10px">
        <canvas id="logoBlob" width="32" height="32" aria-hidden="true"></canvas>
        <a href="#/" style="font-family:ui-serif,Georgia,serif; letter-spacing:.18em; text-transform:uppercase; font-size:13px; color:rgba(37,50,56,.9)">Shapeshifters</a>
      </div>
      <nav>
        <a href="#/guild">The Guild</a>
        <a href="#/rubric">Rubric</a>
        <a href="#/directory">Directory</a>
        <a href="#/membership">Membership</a>
        <a href="#/stories">Stories</a>
        <a href="#/commons">Commons</a>
        <a href="#/signals">Signals</a>
        <a href="#/chapters">Chapters</a>
        <button class="btn btn-cream" data-nav="membership">Join</button>
      </nav>
    </div>
  </header>

  <main id="app"></main>

  <div class="qs">
    <button class="btn" style="background:transparent; color:var(--ink); border:1px solid rgba(0,0,0,.12)" data-nav="home">Home</button>
    <button class="btn" style="background:transparent; color:var(--ink); border:1px solid rgba(0,0,0,.12)" data-nav="rubric">Rubric</button>
    <button class="btn" style="background:transparent; color:var(--ink); border:1px solid rgba(0,0,0,.12)" data-nav="directory">Directory</button>
    <button class="btn" style="background:transparent; color:var(--ink); border:1px solid rgba(0,0,0,.12)" data-nav="stories">Stories</button>
    <button class="btn" style="background:transparent; color:var(--ink); border:1px solid rgba(0,0,0,.12)" data-nav="commons">Commons</button>
  </div>

  <footer class="footer">
    <div class="container row">
      <div class="row" style="gap:10px">
        <canvas id="footerBlob" width="28" height="28" aria-hidden="true"></canvas>
        <span style="font-family:ui-serif,Georgia,serif; letter-spacing:.18em; text-transform:uppercase; font-size:13px; color:rgba(37,50,56,.8)">Shapeshifters</span>
      </div>
      <div class="muted">© 2025 Shapeshifters — Grow the Commons • <span id="ver"></span>.</div>
    </div>
  </footer>

  <script>
    // ---------- Version stamp
    (function(){
      try{
        const fmt = new Intl.DateTimeFormat('en-AU',{ timeZone:'Australia/Melbourne', year:'numeric', month:'2-digit', day:'2-digit', hour:'2-digit', minute:'2-digit', hour12:false });
        const p = Object.fromEntries(fmt.formatToParts(new Date()).map(x=>[x.type,x.value]));
        window.__VERSION__ = `shapes.v-guild-${p.year}${p.month}${p.day}-${p.hour}${p.minute}`;
      }catch{ window.__VERSION__ = 'shapes.v-guild'; }
      document.getElementById('ver').textContent = window.__VERSION__;
    })();

    // ---------- Palette
    const PALETTE = {
      sky:getComputedStyle(document.documentElement).getPropertyValue('--sky').trim(),
      sand:getComputedStyle(document.documentElement).getPropertyValue('--sand').trim(),
      mint:getComputedStyle(document.documentElement).getPropertyValue('--mint').trim(),
      cream:getComputedStyle(document.documentElement).getPropertyValue('--cream').trim(),
      coral:getComputedStyle(document.documentElement).getPropertyValue('--coral').trim(),
      ink:getComputedStyle(document.documentElement).getPropertyValue('--ink').trim()
    };

    // ---------- Morphing blob (vanilla canvas)
    function morphBlob(canvas, opts={}){
      const ctx = canvas.getContext('2d'); if(!ctx) return;
      const dpr = Math.max(1, Math.min(2, window.devicePixelRatio||1));
      const width = canvas.width, height = canvas.height;
      let t0 = performance.now();
      function paint(){
        const t = (performance.now()-t0)/1000*(opts.speed||1.4);
        ctx.clearRect(0,0,width,height); ctx.save(); ctx.translate(width/2,height/2);
        const n = opts.detail||140, R = Math.min(width,height)*0.36, a = (opts.amplitude||0.22);
        ctx.shadowColor='rgba(231,209,161,0.45)'; ctx.shadowBlur=20*dpr;
        ctx.beginPath();
        for(let i=0;i<=n;i++){
          const ang = (i/n)*Math.PI*2;
          const wob = Math.sin(ang*3 + t*1.3)*0.9 + Math.sin(ang*7 - t*1.7)*0.5 + Math.sin(ang*11 + t*2.2)*0.3;
          const r = R * (1 + a*wob);
          const x = Math.cos(ang)*r, y=Math.sin(ang)*r; (i===0)?ctx.moveTo(x,y):ctx.lineTo(x,y);
        }
        ctx.closePath();
        const grad = ctx.createRadialGradient(0,0,R*0.2,0,0,R*1.15);
        const stops = opts.stops || [PALETTE.cream, PALETTE.mint, PALETTE.coral];
        grad.addColorStop(0, stops[0]); grad.addColorStop(0.48, stops[1]); grad.addColorStop(1, stops[2]);
        ctx.globalAlpha = (opts.opacity || 0.95); ctx.fillStyle = grad; ctx.fill();
        ctx.globalAlpha = 0.25; ctx.lineWidth = 2*dpr; ctx.strokeStyle = 'rgba(40,60,60,0.25)'; ctx.stroke();
        ctx.restore();
        canvas.__raf__ = requestAnimationFrame(paint);
      }
      canvas.__raf__ && cancelAnimationFrame(canvas.__raf__);
      canvas.__raf__ = requestAnimationFrame(paint);
    }
    morphBlob(document.getElementById('logoBlob'), {width:32,height:32, detail:120, amplitude:0.22, speed:1.6, stops:['#FFF5EA','#FFC7A6','#FF6B5C']});
    morphBlob(document.getElementById('footerBlob'), {width:28,height:28, detail:120, amplitude:0.22, speed:1.6, stops:['#FFF5EA','#FFC7A6','#FF6B5C']});

    // ---------- Data
    const FACILITATORS = [
      { name: "Amara Solberg", level:"Fellow", availability:"Open Q4", stance:"Designs for flow; cares for consent.", role: "Org Designer", region: "EU", langs: "EN/SE", sectors: "Gov, Health", tools: "RAPID -> Flows", featuredInStories:['ep-001'] },
      { name: "Kenji Duarte", level:"Member", availability:"Limited", stance:"Policy foresight with civic lens.", role: "Policy Foresight Lead", region: "APAC", langs: "EN/JP", sectors: "Finance, Infra", tools: "Scenarios, Backcasting" },
      { name: "Lina Ashworth", level:"Member", availability:"Open", stance:"From hype to useful pipelines.", role: "AI Adoption Coach", region: "US/EU", langs: "EN/ES", sectors: "Tech, Media", tools: "Use-case Pipeline, Safety", featuredInStories:['ep-002'] },
      { name: "Mateo Kline", level:"Member", availability:"Book for Nov", stance:"Repair before speed.", role: "Conflict & Repair", region: "US", langs: "EN", sectors: "Civic, Health", tools: "RJ, TRJ, Protocol Design" },
      { name: "Sana Mbaye", level:"Member", availability:"Open", stance:"Measure what matters.", role: "Measurement Architect", region: "EU/AF", langs: "EN/FR", sectors: "Public, Cities", tools: "Metrics, M&E" },
      { name: "Noah Vaziri", level:"Member", availability:"Open", stance:"Rooms first, artefacts second.", role: "Facilitation Craft", region: "MENA/EU", langs: "EN/FA", sectors: "Energy, Policy", tools: "Room Design, Safety" },
      { name: "Edda Sorensen", level:"Member", availability:"Open", stance:"Narratives that align action.", role: "Culture Change", region: "EU", langs: "EN/NO", sectors: "Creative, Gov", tools: "Narratives, Rituals" },
      { name: "Tariq Bhatt", level:"Member", availability:"Waitlist", stance:"Decisions, not decks.", role: "Ops Model Reset", region: "APAC", langs: "EN/HI", sectors: "Manufacturing", tools: "Decision Rights, Incentives" },
      { name: "Zuri Alcott", level:"Member", availability:"Open", stance:"Guardrails without friction.", role: "Ethics & Risk", region: "US", langs: "EN", sectors: "Health, Finance", tools: "Model Risk, Guardrails" },
      { name: "Hannes Petrov", level:"Member", availability:"Open", stance:"Systems maps that move work.", role: "Systems Mapper", region: "EU", langs: "EN/DE", sectors: "Infra, Climate", tools: "Causal Loops, SFD" },
      { name: "Mireya Quinn", level:"Fellow", availability:"Open", stance:"Field labs for real change.", role: "Labs Director", region: "EU/US", langs: "EN/ES", sectors: "Gov, Education", tools: "Field Labs" },
      { name: "Rohan Keita", level:"Member", availability:"Open", stance:"Signals to brief decisions.", role: "Signal Analyst", region: "APAC", langs: "EN", sectors: "Tech, Cities", tools: "Signals, Briefs" },
    ];
    const INSIGHTS = [
      { kind: "Essay", title: "Beyond Roles: Designing for Flow in AI-Shaped Orgs", author: "Amara Solberg", date: "2025-08-10" },
      { kind: "Field Note", title: "What Actually Happens in a Transition Room", author: "Mireya Quinn", date: "2025-07-28" },
      { kind: "Playbook", title: "Use-Case Pipeline: From Hype to Utility", author: "Lina Ashworth", date: "2025-07-16" },
      { kind: "Signal Brief", title: "City-Scale Autonomy Pilots: Early Lessons", author: "Rohan Keita", date: "2025-06-30" },
      { kind: "Essay", title: "Decision Rights in the Age of Agents", author: "Tariq Bhatt", date: "2025-06-12" },
      { kind: "Field Note", title: "Repairing a Board Split (Anonymised)", author: "Mateo Kline", date: "2025-05-22" },
    ];
    const STORIES = [
      { id:"ep-001", kind:"audio", title:"Holding Hard Rooms", guest:"Amara Solberg", tags:["Roomcraft","Consent"], duration:"34:12", audioUrl:"", summary:"On consent, boundaries and decision clarity.", date:"2025-08-01", facilitatorName:"Amara Solberg" },
      { id:"ep-002", kind:"audio", title:"From Hype to Pipeline", guest:"Lina Ashworth", tags:["AI Adoption","Safety"], duration:"29:05", audioUrl:"", summary:"Making useful pipelines.", date:"2025-07-12", facilitatorName:"Lina Ashworth" },
      { id:"st-101", kind:"read", title:"A Repair Done Right", guest:"Mateo Kline", tags:["Conflict","Repair"], duration:"5 min read", summary:"What changed when the room slowed down.", date:"2025-06-22", facilitatorName:"Mateo Kline" },
    ];
    const COMMONS = [
      { cat:"Rituals", items:["Opening consent", "Temperature check", "Repair protocol"] },
      { cat:"Room patterns", items:["Transition Room", "Alignment Intensive", "Scenario Lab"] },
      { cat:"Templates", items:["Decision rights", "Use-case pipeline", "Metrics"] },
      { cat:"Safeguards", items:["Model risk checklist", "Ethics thresholds", "Escalation"] },
    ];
    const EVENTS = [
      { when: "Oct 11", name: "Annual Gathering", where: "Brussels", seats: 180 },
      { when: "Oct 24", name: "Signals Salon: Health", where: "London", seats: 60 },
      { when: "Nov 7", name: "Facilitator Practicum", where: "Berlin", seats: 40 },
    ];

    // ---------- Utilities
    function initials(name){ return name.split(" ").map(n=>n[0]||"").join("").slice(0,2).toUpperCase(); }
    function avatarDataUri(name, i = 0){
      const init = initials(name);
      const stops = ['#FFFFFF', '#9CCFD3', '#BFDCD2', '#FF6B5C'];
      const a = stops[i % stops.length];
      const b = stops[(i + 1) % stops.length];
      const svg = encodeURIComponent(`
        <svg xmlns='http://www.w3.org/2000/svg' width='240' height='240'>
          <defs><linearGradient id='g' x1='0' y1='0' x2='1' y2='1'>
            <stop offset='0%' stop-color='${a}'/><stop offset='100%' stop-color='${b}'/></linearGradient>
          </defs>
          <rect width='100%' height='100%' fill='url(#g)'/>
          <circle cx='120' cy='120' r='84' fill='rgba(0,0,0,0.06)'/>
          <text x='50%' y='54%' dominant-baseline='middle' text-anchor='middle'
            font-family='ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial' font-size='72' fill='${PALETTE.ink}' opacity='0.85'>${init}</text>
        </svg>`);
      return `data:image/svg+xml;charset=UTF-8,${svg}`;
    }

    // ---------- Router
    const app = document.getElementById('app');
    function routeFromHash(){
      const h = (location.hash || '#/').replace('#/','');
      if (h.startsWith('guild')) return 'guild';
      if (h.startsWith('rubric')) return 'rubric';
      if (h.startsWith('directory') || h.startsWith('network')) return 'directory';
      if (h.startsWith('membership')) return 'membership';
      if (h.startsWith('stories')) return 'stories';
      if (h.startsWith('commons') || h.startsWith('programs')) return 'commons';
      if (h.startsWith('signals') || h.startsWith('insights')) return 'signals';
      if (h.startsWith('chapters') || h.startsWith('events')) return 'chapters';
      return 'home';
    }
    function go(r){ location.hash = r==='home' ? '/' : `/${r}`; }
    window.go = go; // expose for any inline handlers, and tests

    // ---------- Views (string templates + event binding)
    function Hero(){
      return `
        <section class="hero">
          <div class="hero-inner container">
            <div class="pill">The Guild for Transformation</div>
            <h1 style="margin-top:12px">A Professional Home for People Who Guide Change</h1>
            <p style="margin:20px auto 0; max-width:720px">We recognise and resource the people who guide transitions — where AI reshapes value, jobs and governance, and organisations must act with care in ambiguity.</p>
            <div style="margin-top:24px; display:flex; gap:10px; flex-wrap:wrap; justify-content:center">
              <button class="btn" style="background:linear-gradient(135deg, #9CCFD3, #FF6B5C); color:#0B1A1F; box-shadow:0 6px 20px rgba(255,107,92,0.25)" data-nav="membership">Apply to the Guild</button>
              <button class="btn btn-outline-coral" data-nav="membership">Nominate a Colleague</button>
              <button class="btn btn-cream" data-nav="directory">Find a Shapeshifter</button>
            </div>
          </div>
          <div class="center" style="position:absolute; inset: auto 0 -140px 0; z-index:0; pointer-events:none">
            <canvas id="heroBlob" width="240" height="240" aria-hidden="true"></canvas>
          </div>
        </section>
      `;
    }
    function AboutIdentity(){
      const bullets = ["Holds tough rooms with care","Makes direction legible in ambiguity","Designs processes, not just workshops","Practices ethics & consent, not just outcomes"];
      return `
        <section class="section">
          <div class="container grid grid-2" style="align-items:center">
            <div>
              <h2>Are you a Shapeshifter?</h2>
              <ul>${bullets.map(x=>`<li>${x}</li>`).join('')}</ul>
              <button class="btn btn-mint" data-nav="rubric">Take the self-check</button>
            </div>
            <div class="card">
              <h3>The Badge</h3>
              <p>A peer-reviewed credential grounded in ethics, practice hours and contribution.</p>
              <div style="margin-top:8px"><button class="btn btn-cream" data-nav="guild">Read the Code of Practice</button></div>
            </div>
          </div>
        </section>
      `;
    }
    function TitlesExplained(){
      const titles = ["Facilitator","Org Designer","Coach / Transformation Lead","Mediator / Conflict & Repair","Foresight & Policy","AI Adoption & Safety","Measurement Architect","Culture & Narrative"];
      const copy = [
        "Holds live rooms through conflict and ambiguity. Designs sequences that surface truth, reframe, decide, and commit. In an AI context: pairs human deliberation with model-assisted sensemaking.",
        "Shapes operating models, decision rights and incentives. When agents automate coordination, re-draws flows so humans focus on judgment and care.",
        "Builds executive and team capacity to navigate the unknown. Turns strategy into smallest safe steps; protects learning loops amid pressure.",
        "Repairs frayed relationships so work can move. Establishes protocols for consent, boundaries and escalation — crucial where AI raises stakes and speeds.",
        "Makes long-horizon change legible. Builds scenario sets, option spaces and policy guardrails so adoption is safe, equitable and economically sound.",
        "Turns hype into useful pipelines with thresholds for harm, drift and privacy. Couples delivery metrics with socio-technical safeguards.",
        "Aligns incentives to new forms of value. Measures flow, quality, safety and equity — not just throughput.",
        "Names the story people can move in. Creates rituals that keep dignity in the loop as automation rises."
      ];
      return `
        <section class="section">
          <div class="container">
            <h2>Shapeshifter: the craft in a changing economy</h2>
            <p style="max-width:780px">AI is rewiring value chains and decision flows. Autonomous agents take on coordination; interfaces collapse; customers expect real-time adaptation. In this shift, someone has to hold the hard rooms: making direction legible, securing consent, and designing the path from words to work. That professional is a <em>Shapeshifter</em>.</p>
            <p style="max-width:780px">Titles vary by context — coach, facilitator, org designer, policy or foresight lead, transformation officer, mediator — but the craft rhymes. The guild recognises that craft, sets standards for safety and ethics, and grows a commons of re-usable patterns.</p>
            <div class="grid grid-3" style="margin-top:24px">
              ${titles.map((t,i)=>`
                <div class="card">
                  <h3>${t}</h3>
                  <p style="font-size:14px">${copy[i]}</p>
                </div>
              `).join('')}
            </div>
          </div>
        </section>
      `;
    }
    function CommonsTeaser(){
      return `
        <section class="section">
          <div class="container">
            <div style="display:flex; align-items:flex-end; justify-content:space-between; gap:16px">
              <h2>Grow the Commons</h2>
              <button class="btn btn-cream" data-nav="commons">Browse the Library</button>
            </div>
            <div class="grid grid-4" style="margin-top:16px">
              ${COMMONS.map(b=>`
                <div class="card">
                  <h3>${b.cat}</h3>
                  <ul>${b.items.map(it=>`<li>${it}</li>`).join('')}</ul>
                </div>
              `).join('')}
            </div>
          </div>
        </section>
      `;
    }
    function DirectoryTeasers(){
      return `
        <section class="section">
          <div class="container grid grid-2">
            <div class="card">
              <h3 style="font-size:28px">Directory</h3>
              <p>A vetted guild of practitioners with sector depth and the craft to hold transformative rooms.</p>
              <button class="btn btn-mint" data-nav="directory">Browse profiles</button>
            </div>
            <div class="card">
              <h3 style="font-size:28px">Stories</h3>
              <p>Listen to Shapeshifters and read the patterns behind their practice.</p>
              <button class="btn btn-cream" data-nav="stories">Open Stories</button>
            </div>
          </div>
        </section>
      `;
    }
    function ChaptersSignals(){
      return `
        <section class="section">
          <div class="container grid grid-2">
            <div class="card">
              <h3 style="font-size:28px">Chapters & Events</h3>
              <ul>${EVENTS.map(e=>`<li>${e.when} • ${e.where} — ${e.name}</li>`).join('')}</ul>
              <button class="btn btn-cream" data-nav="chapters">Start a Chapter</button>
            </div>
            <div class="card">
              <h3 style="font-size:28px">Signals</h3>
              <ul>${INSIGHTS.slice(0,3).map(a=>`<li>${a.kind} — ${a.title}</li>`).join('')}</ul>
              <button class="btn btn-mint" data-nav="signals">Read Signals</button>
            </div>
          </div>
        </section>
      `;
    }

    // Subpage hero
    function SubHero(title, blurb){
      return `
        <section class="sub-hero">
          <div class="inner">
            <h1 style="font-size:clamp(32px,4.8vw,64px)">${title}</h1>
            <p style="max-width:720px; margin:16px auto 0">${blurb}</p>
            <div class="center" style="margin-top:36px"><canvas class="subBlob" width="180" height="180" aria-hidden="true"></canvas></div>
          </div>
        </section>
      `;
    }

    // Pages
    function Home(){
      return [
        Hero(), AboutIdentity(), TitlesExplained(),
        CommonsTeaser(), DirectoryTeasers(), ChaptersSignals()
      ].join('');
    }
    function Directory(){
      return [
        SubHero('Directory','Titles vary. The work rhymes. Browse Shapeshifters by craft, sector, region and language.'),
        `<section class="section"><div class="container">
          <div class="muted" style="text-align:center; margin-bottom:8px">Profiles available: ${FACILITATORS.length}</div>
          <div style="display:flex; gap:12px; flex-wrap:wrap; align-items:center; justify-content:space-between">
            <input id="q" class="input" placeholder="Search skills, sector, name…" style="max-width:420px" />
            <div id="count" class="muted"></div>
          </div>
          <div id="cards" class="grid grid-3" style="margin-top:16px"></div>
        </div></section>`
      ].join('');
    }
    function Rubric(){
      const items = [
        { id:'room', axis:'Roomcraft & Safety', text:'I can hold conflict and maintain consent and boundaries during facilitation.' },
        { id:'systems', axis:'Systems Sense', text:'I map dependencies and design flows beyond one-off workshops.' },
        { id:'gen', axis:'Generative Practice', text:'I create reusable patterns (rituals, formats, templates) from engagements.' },
        { id:'evidence', axis:'Evidence & Outcomes', text:'I can point to traceable improvements or learning artefacts.' },
        { id:'ethics', axis:'Ethics & Care', text:'I practice confidentiality, informed consent, equity and repair pathways.' },
        { id:'community', axis:'Community Contribution', text:'I mentor/teach, help chapters, or contribute to the commons.' },
      ];
      return [
        SubHero('Rubric','A public self-check for the craft. Different titles, shared work: guiding real transitions where AI reshapes value, jobs and governance.'),
        `<section class="section"><div class="container">
          <div class="card" style="display:grid; gap:12px"><h3 style="font-size:28px">What we mean by "Shapeshifter"</h3><p>People who do this work are called many things: executive coaches, transformation designers, disruption officers, facilitators. Different labels for a shared craft — guiding organisations and communities through moments of change and ambiguity.</p><p>From the outside it can look abstract. In practice it is concrete and urgent: making direction legible, securing consent, and turning ambiguity into safe, coordinated moves — especially now, as AI and economic shifts rewire value chains, jobs and governance.</p><p>The guild is formed, the professional standards are articulated, and the community is growing. The name sums up what many of us have been doing in our own contexts — easing and guiding transformation, shifting organisations and people through changing times. We are gathering our peers and growing our commons under one unifying, non‑profit home: The Shapeshifters.</p></div>
          <div class="card">
            ${items.map(it=>`
              <div style="padding:14px 0; border-bottom:1px solid var(--border)">
                <div class="muted" style="text-transform:uppercase; letter-spacing:.08em">${it.axis}</div>
                <div style="font-family:ui-serif,Georgia,serif; font-size:22px">${it.text}</div>
                <div style="margin-top:8px; display:flex; gap:8px; align-items:center">
                  ${[0,1,2,3,4].map(v=>`<button class="btn" data-score="${it.id}-${v}" style="border:1px solid var(--border); background:transparent">${v}</button>`).join('')}
                  <span class="muted">0–4 scale</span>
                </div>
              </div>
            `).join('')}
            <div style="display:flex; gap:16px; align-items:center; justify-content:space-between; padding-top:14px">
              <div>
                <div class="muted" style="text-transform:uppercase; letter-spacing:.08em">Your band</div>
                <div id="band" style="font-family:ui-serif,Georgia,serif; font-size:28px">Member <span class="muted" id="total">(12/24)</span></div>
              </div>
              <div>
                <button class="btn btn-mint" data-nav="membership" id="cta1">Apply to the Guild</button>
                <button class="btn btn-cream" id="cta2">Share results</button>
              </div>
            </div>
            <p class="muted" style="margin-top:8px">Note: Member = 14–18. Fellow = 19–24 with contribution track. Ethics & Roomcraft should not be below 2 in peer review.</p>
          </div>
        </div></section>`
      ].join('');
    }
    function Stories(){
      const tabs = ['All','Audio','Read'];
      return [
        SubHero('Shapeshifter Stories','Listen or read. Cross-linked to the Directory.'),
        `<section class="section"><div class="container">
          <div id="tabs">${tabs.map(k=>`<button class="btn" data-tab="${k}" style="border:1px solid var(--border); background:transparent">${k}</button>`).join(' ')}</div>
          <div id="stories" class="grid grid-3" style="margin-top:16px"></div>
        </div></section>`
      ].join('');
    }
    function Commons(){
      return [
        SubHero('Commons','Rituals, patterns, templates and safeguards to grow the craft.'),
        `<section class="section"><div class="container">
          <div class="grid grid-4">
            ${COMMONS.map(b=>`
              <div class="card">
                <h3>${b.cat}</h3>
                <ul>${b.items.map(it=>`<li>${it}</li>`).join('')}</ul>
                <button class="btn btn-cream" style="margin-top:8px">View</button>
              </div>`).join('')}
          </div>
        </div></section>`
      ].join('');
    }
    function Signals(){
      const tabs = ['All','Essay','Field Note','Playbook','Signal Brief'];
      return [
        SubHero('Signals','Essays, briefs and field notes from the practice.'),
        `<section class="section"><div class="container">
          <div id="sigTabs">${tabs.map(k=>`<button class="btn" data-sigtab="${k}" style="border:1px solid var(--border); background:transparent">${k}</button>`).join(' ')}</div>
          <div id="insights" class="grid grid-3" style="margin-top:16px"></div>
        </div></section>`
      ].join('');
    }
    function Guild(){
      return [
        SubHero('The Guild','Manifesto, Why Now (AI & the economy), Code of Practice, Ethics & Governance.'),
        `<section class="section"><div class="container"><div class="card" style="display:grid; gap:28px">
          <div><h3 style="font-size:28px">Manifesto</h3>
            <p>Change is constant; care is a choice. Our craft is to hold rooms where direction becomes clear and action becomes safe. We stand for consent over coercion, clarity over theatre, and learning over posturing.</p>
            <p>The Shapeshifter works on the boundary — between people and systems, judgment and automation, possibility and commitment. The guild recognises the craft and protects the conditions it needs.</p>
          </div>
          <div><h3 style="font-size:28px">Why now: AI & the economic shift</h3>
            <ul>
              <li>Agents are taking on coordination and content; human work tilts to judgment, care and governance.</li>
              <li>Value chains compress; decisions move to the edge; policy and compliance race to keep pace.</li>
              <li>Trust becomes differentiator: safety, consent, equity and repair matter as much as speed.</li>
            </ul>
            <p>In this context, Shapeshifters make direction legible, negotiate trade-offs, and turn decisions into moves. We elevate the craft and set peer standards.</p>
          </div>
          <div><h3 style="font-size:28px">Titles & shared craft</h3>
            <p>Coach, facilitator, org designer, policy or foresight lead, transformation officer, mediator, culture or measurement specialist — different doors into the same room. The work is roomcraft, systems sense, generative practice, evidence, ethics and contribution. That's our rubric and our badge.</p>
          </div>
          <div><h3 style="font-size:28px">Code of Practice</h3>
            <ul>
              <li>Confidentiality & informed consent</li>
              <li>Safety & inclusion</li>
              <li>Clear decisions & follow-through</li>
              <li>Ethics, safeguards & escalation</li>
            </ul>
          </div>
          <div><h3 style="font-size:28px">Governance</h3>
            <p>Non-profit model; steward circle; member votes. Dues and sponsorships fund chapters, care work and the commons.</p>
          </div>
        </div></div></section>`
      ].join('');
    }
    function Membership(){
      return [
        SubHero('Membership','Levels, benefits and how to apply or nominate a colleague.'),
        `<section class="section"><div class="container">
          <div class="grid grid-2">
            <div class="card">
              <h3>Levels</h3>
              <ul>
                <li><strong>Member</strong> — peer-reviewed entry; directory, commons, chapters, use of title.</li>
                <li><strong>Fellow</strong> — recognised contribution (teach/research/steward); review panel.</li>
                <li><strong>Emeritus</strong> — retired practitioners; mentoring pathway.</li>
              </ul>
            </div>
            <div class="card">
              <h3>Apply / Nominate</h3>
              <div style="display:grid; gap:10px; margin-top:8px">
                <input class="input" placeholder="Your name" />
                <input class="input" placeholder="Email" />
                <select class="input"><option>Path</option><option>Apply</option><option>Nominate</option></select>
                <textarea class="input" placeholder="Portfolio link + short context" rows="4"></textarea>
                <button class="btn btn-mint">Send</button>
              </div>
            </div>
          </div>
        </div></section>`
      ].join('');
    }
    function Chapters(){
      return [
        SubHero('Chapters','City chapters, salons, labs and the annual gathering.'),
        `<section class="section"><div class="container">
          <div class="card">
            <h3>Upcoming</h3>
            <ul>${EVENTS.map(e=>`<li>${e.when} • ${e.where} — ${e.name}</li>`).join('')}</ul>
            <button class="btn btn-cream" style="margin-top:8px">Start a Chapter</button>
          </div>
        </div></section>`
      ].join('');
    }

    // ---------- Render & navigation binding
    function render(){
      const r = routeFromHash();
      let html = '';
      if (r==='home') html = Home();
      else if (r==='guild') html = Guild();
      else if (r==='rubric') html = Rubric();
      else if (r==='directory') html = Directory();
      else if (r==='membership') html = Membership();
      else if (r==='stories') html = Stories();
      else if (r==='commons') html = Commons();
      else if (r==='signals') html = Signals();
      else if (r==='chapters') html = Chapters();
      app.innerHTML = html;

      // Bind in-app nav buttons
      app.querySelectorAll('[data-nav]').forEach(el => el.addEventListener('click', () => { go(el.getAttribute('data-nav')); }));

      // Start sub-hero blob(s)
      app.querySelectorAll('.subBlob').forEach(c => morphBlob(c, {detail:180, amplitude:0.22, speed:1.4, stops:['#FFF5EA','#FFC7A6','#FF6B5C']}));

      // Home hero blob
      const hb = document.getElementById('heroBlob'); if (hb) morphBlob(hb, {detail:200, amplitude:0.26, speed:1.7, stops:['#FFF5EA','#FFC7A6','#FF6B5C']});

      // Directory filtering
      const q = document.getElementById('q');
      const cards = document.getElementById('cards');
      const count = document.getElementById('count');
      if (q && cards){
        const draw = () => {
          const term = q.value.toLowerCase();
          const list = FACILITATORS.filter(f => (f.name+f.role+f.sectors+f.tools+f.region+f.stance).toLowerCase().includes(term));
          count.textContent = `Showing ${list.length} result${list.length===1?'':'s'}`;
          cards.innerHTML = list.map((f,i)=>`
            <div class="card" style="padding:0">
              <div class="avatar" style="background-image:url('${avatarDataUri(f.name,i)}')"</div>
              <div style="padding:18px">
                <div style="display:flex; align-items:center; justify-content:space-between">
                  <h3>${f.name}</h3>
                  <span style="font-size:11px; letter-spacing:.08em; text-transform:uppercase; color:var(--mint)}">${f.region}</span>
                </div>
                <p>${f.role} • <span class="muted">${f.level}</span></p>
                <p style="font-size:14px">${f.stance}</p>
                ${f.featuredInStories && f.featuredInStories.length ? `<div class="tag" style="border-color: var(--coral); color:var(--coral)">Featured on Stories</div>` : ''}
              </div>
            </div>
          `).join('');
        };
        q.addEventListener('input', draw); draw();
      }

      // Rubric scoring
      const scoreBtns = app.querySelectorAll('[data-score]');
      if (scoreBtns.length){
        const scores = {room:2, systems:2, gen:2, evidence:2, ethics:2, community:2};
        const update = () => {
          const total = Object.values(scores).reduce((a,b)=>a+(b||0),0);
          const band = total>=19 ? 'Fellow' : total>=14 ? 'Member' : 'Explore';
          document.getElementById('band').innerHTML = `${band} <span class="muted" id="total">(${total}/24)</span>`;
          document.getElementById('cta1').textContent = band==='Explore' ? 'Find a Mentor' : 'Apply to the Guild';
        };
        scoreBtns.forEach(b => b.addEventListener('click', ()=>{
          const [id,v] = b.getAttribute('data-score').split('-');
          scores[id] = Number(v); update();
        }));
        update();
      }

      // Stories tabs
      const tabs = app.querySelectorAll('[data-tab]');
      const sroot = document.getElementById('stories');
      if (tabs.length && sroot){
        let kind = 'All';
        const drawStories = () => {
          const list = kind==='All' ? STORIES : STORIES.filter(s => kind==='Audio' ? s.kind==='audio' : s.kind==='read');
          sroot.innerHTML = list.map(s=>`
            <article class="card">
              <div class="muted">${s.kind==='audio'?'Episode':'Story'} • ${s.date}</div>
              <h3>${s.title}</h3>
              <p class="muted">${s.guest || ''}</p>
              <p style="font-size:14px">${s.summary}</p>
              <div>${s.tags.map(t=>`<span class="tag">${t}</span>`).join('')}</div>
              ${s.kind==='audio' ? `<audio controls preload="none" style="width:100%; margin-top:8px"></audio>` : ''}
            </article>
          `).join('');
        };
        tabs.forEach(t => t.addEventListener('click', ()=>{ kind = t.getAttribute('data-tab'); drawStories(); }));
        drawStories();
      }

      // Signals tabs
      const sigTabs = app.querySelectorAll('[data-sigtab]');
      const iroot = document.getElementById('insights');
      if (sigTabs.length && iroot){
        let tab = 'All';
        const drawInsights = () => {
          const list = tab==='All' ? INSIGHTS : INSIGHTS.filter(a=>a.kind===tab);
          iroot.innerHTML = list.map(a=>`
            <article class="card">
              <div class="muted">${a.kind} • ${a.date}</div>
              <h3>${a.title}</h3>
              <p class="muted">${a.author}</p>
            </article>
          `).join('');
        };
        sigTabs.forEach(t => t.addEventListener('click', ()=>{ tab = t.getAttribute('data-sigtab'); drawInsights(); }));
        drawInsights();
      }
    }

    // Bind quick-switch buttons to router (no inline handlers needed)
    document.querySelectorAll('.qs [data-nav]').forEach(b=>{
      b.addEventListener('click', ()=> go(b.getAttribute('data-nav')));
    });

    window.addEventListener('hashchange', render);
    render();

    // ---------- Minimal tests (won't interrupt UI)
    (function tests(){
      try{
        console.assert(typeof window.go === 'function', 'go should be defined');
        const r = routeFromHash();
        console.assert(['home','guild','rubric','directory','membership','stories','commons','signals','chapters'].includes(r), 'router returns known route');
      }catch(e){ console.warn('Self-tests failed:', e); }
    })();
  </script>
</body>
</html>